{"nbformat":4,"nbformat_minor":0,"metadata":{"colab":{"provenance":[],"machine_shape":"hm","gpuType":"A100","authorship_tag":"ABX9TyO7RPILUJln7uLPMsh0buGL"},"kernelspec":{"name":"python3","display_name":"Python 3"},"language_info":{"name":"python"},"accelerator":"GPU","widgets":{"application/vnd.jupyter.widget-state+json":{"0fc9605fab0a48b891a5514c430caaa8":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_0b439aae6fce4f41bae17e2557e9f782","IPY_MODEL_1f3ef5a9a59e49cf93ac45a2c4529688","IPY_MODEL_3323b7221d99402b82b35096759ad632"],"layout":"IPY_MODEL_e7cea87cdfe14ac8868f60d89dc6c58a"}},"0b439aae6fce4f41bae17e2557e9f782":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_cadc8dd38a0e40ff937044fbca8180c9","placeholder":"​","style":"IPY_MODEL_31fd7a5865594895bf020059f437964e","value":"Downloading (…)/adapter_config.json: 100%"}},"1f3ef5a9a59e49cf93ac45a2c4529688":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_d02350d6a5964739b031e73dc03d7c7b","max":505,"min":0,"orientation":"horizontal","style":"IPY_MODEL_b65d2323a22c46b3af8570a064221ae2","value":505}},"3323b7221d99402b82b35096759ad632":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_57c62271518441ebb97c1af08382cb22","placeholder":"​","style":"IPY_MODEL_516fde358840463cb65a7a486f98fae6","value":" 505/505 [00:00&lt;00:00, 45.5kB/s]"}},"e7cea87cdfe14ac8868f60d89dc6c58a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"cadc8dd38a0e40ff937044fbca8180c9":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"31fd7a5865594895bf020059f437964e":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"d02350d6a5964739b031e73dc03d7c7b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"b65d2323a22c46b3af8570a064221ae2":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"57c62271518441ebb97c1af08382cb22":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"516fde358840463cb65a7a486f98fae6":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"be123d228aff49c4907fc01cfc1d8d1e":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_cb88ef1c73d54269bbce5d4a4c2e4e39","IPY_MODEL_490cef4469204d1994c0fb8deaf3fe7e","IPY_MODEL_2506d403087c406a91e10be72c8f51c8"],"layout":"IPY_MODEL_95caa8fab377447a83d8f51ae9e8b743"}},"cb88ef1c73d54269bbce5d4a4c2e4e39":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_33ed355504ab44169865b7b7c6dc29e6","placeholder":"​","style":"IPY_MODEL_ef644310b16d4c978a2194dea831c816","value":"Loading checkpoint shards: 100%"}},"490cef4469204d1994c0fb8deaf3fe7e":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_10c1aa32d97c4c1d88f4bbd1286f7581","max":3,"min":0,"orientation":"horizontal","style":"IPY_MODEL_124c3db9eb884f98a3c235bd68b736dc","value":3}},"2506d403087c406a91e10be72c8f51c8":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_473a06b66ca84df38a1391f0687ecc00","placeholder":"​","style":"IPY_MODEL_68906a03ff554a9daad66dd4870f6f7f","value":" 3/3 [00:18&lt;00:00,  5.72s/it]"}},"95caa8fab377447a83d8f51ae9e8b743":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"33ed355504ab44169865b7b7c6dc29e6":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"ef644310b16d4c978a2194dea831c816":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"10c1aa32d97c4c1d88f4bbd1286f7581":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"124c3db9eb884f98a3c235bd68b736dc":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"473a06b66ca84df38a1391f0687ecc00":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"68906a03ff554a9daad66dd4870f6f7f":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"f9b0930b49af44b2b61923823b29c9b1":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_bc5232b40d8c49af96eac567816a3f0e","IPY_MODEL_9489c25966b34c7483c14b960a81f6ed","IPY_MODEL_a0c465c70ec74344a943869d55c588f0"],"layout":"IPY_MODEL_0681760a75d445daabe8083f4530fe78"}},"bc5232b40d8c49af96eac567816a3f0e":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_efaf4c95a4ed4295aa18ae634e65997f","placeholder":"​","style":"IPY_MODEL_310e8b7a9d2145d8aefbaa21a7803488","value":"Downloading adapter_model.bin: 100%"}},"9489c25966b34c7483c14b960a81f6ed":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_f3c3588894b748ae9f9686c91ac47d04","max":117522637,"min":0,"orientation":"horizontal","style":"IPY_MODEL_966f628a971642e9bdd525f682a2f0ed","value":117522637}},"a0c465c70ec74344a943869d55c588f0":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_06df5d006dac48348f0c4dc36ee469a8","placeholder":"​","style":"IPY_MODEL_18bbe2038ca047e28ad17bfeb1806519","value":" 118M/118M [00:07&lt;00:00, 16.8MB/s]"}},"0681760a75d445daabe8083f4530fe78":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"efaf4c95a4ed4295aa18ae634e65997f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"310e8b7a9d2145d8aefbaa21a7803488":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"f3c3588894b748ae9f9686c91ac47d04":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"966f628a971642e9bdd525f682a2f0ed":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"06df5d006dac48348f0c4dc36ee469a8":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"18bbe2038ca047e28ad17bfeb1806519":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}}}}},"cells":[{"cell_type":"code","source":["!pip install -q -U bitsandbytes\n","!pip install -q -U git+https://github.com/huggingface/transformers.git\n","!pip install -q -U git+https://github.com/huggingface/peft.git\n","!pip install -q -U git+https://github.com/huggingface/accelerate.git\n","!pip install -q datasets"],"metadata":{"id":"aERWMrZcsVpO","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1690504643241,"user_tz":-540,"elapsed":67254,"user":{"displayName":"전민규","userId":"17831368244275956825"}},"outputId":"e6cd93e4-8d1f-4738-b8e2-4293f0cba5b7"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m92.6/92.6 MB\u001b[0m \u001b[31m18.0 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h  Installing build dependencies ... \u001b[?25l\u001b[?25hdone\n","  Getting requirements to build wheel ... \u001b[?25l\u001b[?25hdone\n","  Preparing metadata (pyproject.toml) ... \u001b[?25l\u001b[?25hdone\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m268.8/268.8 kB\u001b[0m \u001b[31m4.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m7.8/7.8 MB\u001b[0m \u001b[31m69.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m1.3/1.3 MB\u001b[0m \u001b[31m78.8 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h  Building wheel for transformers (pyproject.toml) ... \u001b[?25l\u001b[?25hdone\n","  Installing build dependencies ... \u001b[?25l\u001b[?25hdone\n","  Getting requirements to build wheel ... \u001b[?25l\u001b[?25hdone\n","  Preparing metadata (pyproject.toml) ... \u001b[?25l\u001b[?25hdone\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m244.2/244.2 kB\u001b[0m \u001b[31m4.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h  Building wheel for peft (pyproject.toml) ... \u001b[?25l\u001b[?25hdone\n","  Installing build dependencies ... \u001b[?25l\u001b[?25hdone\n","  Getting requirements to build wheel ... \u001b[?25l\u001b[?25hdone\n","  Preparing metadata (pyproject.toml) ... \u001b[?25l\u001b[?25hdone\n","  Building wheel for accelerate (pyproject.toml) ... \u001b[?25l\u001b[?25hdone\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m492.4/492.4 kB\u001b[0m \u001b[31m8.6 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m115.3/115.3 kB\u001b[0m \u001b[31m16.4 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m212.5/212.5 kB\u001b[0m \u001b[31m27.0 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m134.8/134.8 kB\u001b[0m \u001b[31m19.5 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h"]}]},{"cell_type":"code","source":["import torch\n","from peft import PeftConfig, PeftModel\n","from transformers import AutoModelForCausalLM, AutoTokenizer, BitsAndBytesConfig"],"metadata":{"id":"Iw5C_y3Osnqw"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["### Load basemodel&Lora adapter\n","-  huggingface: https://huggingface.co/MinGue/Koyangi-5.8B"],"metadata":{"id":"hOziNpdVdiaj"}},{"cell_type":"code","source":["def load_model(Lora_adapter):\n","    config = PeftConfig.from_pretrained(Lora_adapter)\n","\n","    bnb_config = BitsAndBytesConfig(\n","    load_in_4bit=True,\n","    bnb_4bit_use_double_quant=True,\n","    bnb_4bit_quant_type=\"nf4\",\n","    bnb_4bit_compute_dtype=torch.bfloat16,\n","    )\n","\n","    model = AutoModelForCausalLM.from_pretrained(\n","        config.base_model_name_or_path,\n","        return_dict=True,\n","        quantization_config=bnb_config,\n","        device_map=\"auto\",\n","        trust_remote_code=True,\n","        load_in_4bit=True\n","    )\n","\n","    model = PeftModel.from_pretrained(model, Lora_adapter)\n","\n","    return model"],"metadata":{"id":"1m5krZUOct9z"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["Lora_adapter = \"MinGue/Koyangi-5.8B\"\n","model = load_model(Lora_adapter)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":113,"referenced_widgets":["0fc9605fab0a48b891a5514c430caaa8","0b439aae6fce4f41bae17e2557e9f782","1f3ef5a9a59e49cf93ac45a2c4529688","3323b7221d99402b82b35096759ad632","e7cea87cdfe14ac8868f60d89dc6c58a","cadc8dd38a0e40ff937044fbca8180c9","31fd7a5865594895bf020059f437964e","d02350d6a5964739b031e73dc03d7c7b","b65d2323a22c46b3af8570a064221ae2","57c62271518441ebb97c1af08382cb22","516fde358840463cb65a7a486f98fae6","be123d228aff49c4907fc01cfc1d8d1e","cb88ef1c73d54269bbce5d4a4c2e4e39","490cef4469204d1994c0fb8deaf3fe7e","2506d403087c406a91e10be72c8f51c8","95caa8fab377447a83d8f51ae9e8b743","33ed355504ab44169865b7b7c6dc29e6","ef644310b16d4c978a2194dea831c816","10c1aa32d97c4c1d88f4bbd1286f7581","124c3db9eb884f98a3c235bd68b736dc","473a06b66ca84df38a1391f0687ecc00","68906a03ff554a9daad66dd4870f6f7f","f9b0930b49af44b2b61923823b29c9b1","bc5232b40d8c49af96eac567816a3f0e","9489c25966b34c7483c14b960a81f6ed","a0c465c70ec74344a943869d55c588f0","0681760a75d445daabe8083f4530fe78","efaf4c95a4ed4295aa18ae634e65997f","310e8b7a9d2145d8aefbaa21a7803488","f3c3588894b748ae9f9686c91ac47d04","966f628a971642e9bdd525f682a2f0ed","06df5d006dac48348f0c4dc36ee469a8","18bbe2038ca047e28ad17bfeb1806519"]},"id":"KIsLqzNydBvH","executionInfo":{"status":"ok","timestamp":1690507252233,"user_tz":-540,"elapsed":75187,"user":{"displayName":"전민규","userId":"17831368244275956825"}},"outputId":"ecf5f325-aac6-441d-dd72-ab16f01e8fa7"},"execution_count":null,"outputs":[{"output_type":"display_data","data":{"text/plain":["Downloading (…)/adapter_config.json:   0%|          | 0.00/505 [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"0fc9605fab0a48b891a5514c430caaa8"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"be123d228aff49c4907fc01cfc1d8d1e"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Downloading adapter_model.bin:   0%|          | 0.00/118M [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"f9b0930b49af44b2b61923823b29c9b1"}},"metadata":{}}]},{"cell_type":"markdown","source":["### Tokenizer"],"metadata":{"id":"VGxvXfe2dp5B"}},{"cell_type":"code","source":["model_id = \"mncai/Polyglot-7B-Kor100K-epoch2\"\n","tokenizer = AutoTokenizer.from_pretrained(model_id) # padding_side=\"left\"\n","tokenizer.pad_token = tokenizer.eos_token"],"metadata":{"id":"tpvehqnLrw7K"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["### Inference Prompt"],"metadata":{"id":"7zaIhA_iNy1b"}},{"cell_type":"code","source":["answer_prompt_mrc = \"\"\"\n","너는 지시사항을 매우 잘 따르는 AI 어시스턴트야.\n","### 지시사항:\n"," - 주어진 문맥만을 사용하여 질문에 대한 답변을 자세하게 생성해줘.\n"," - 문맥에서 답할 수 없는 질문일 경우 \"해당 질문에 대한 답변을 문서에서 찾을 수 없습니다.\"라고 답변해.\n","\n","### 문맥:\n","<문맥1>\n","{context}\n","\n","### 질문:\n","{question}\n","### 답변:\n","\"\"\"\n","answer_prompt_pdf = \"\"\"\n","너는 지시사항을 매우 잘 따르는 AI 어시스턴트야.\n","### 지시사항:\n"," - 주어진 문맥만을 사용하여 질문에 대한 답변을 자세하게 생성해줘.\n"," - 문맥에서 답할 수 없는 질문일 경우 \"해당 질문에 대한 답변을 문서에서 찾을 수 없습니다.\"라고 답변해.\n","\n","### 문맥:\n","<문맥1>\n","{context1}\n","<문맥2>\n","{context2}\n","<문맥3>\n","{context3}\n","### 질문:\n","{question}\n","### 답변:\n","\"\"\""],"metadata":{"id":"Vf-k5gmR8xps"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["### inference"],"metadata":{"id":"GY7XurkAN11X"}},{"cell_type":"code","source":["from IPython.display import display, Markdown\n","from transformers import StoppingCriteria, StoppingCriteriaList\n","import random\n","\n","class StoppingCriteriaSub(StoppingCriteria):\n","    def __init__(self, stops=[], encounters=1):\n","        super().__init__()\n","        self.stops = [stop for stop in stops]\n","\n","    def __call__(self, input_ids: torch.LongTensor, scores: torch.FloatTensor):\n","        for stop in self.stops:\n","            if torch.all((stop == input_ids[0][-len(stop) :])).item():\n","                return True\n","\n","        return False\n","\n","def make_prompt(context, question):\n","    prompt = answer_prompt_mrc.format(context=context, question=question)\n","    return prompt\n","\n","def make_prompt_pdf(context1, context2, context3,  question):\n","    prompt = answer_prompt_pdf.format(context1=context1, context2=context2, context3=context3, question=question)\n","    return prompt\n","\n","\n","def make_inference(prompt):\n","    inputs = tokenizer(prompt, return_tensors=\"pt\", return_token_type_ids=False).to(\n","        \"cuda:0\"\n","    )\n","    stop_words = [\"</끝>\"]\n","    stop_words_ids = [\n","        tokenizer(stop_word, return_tensors=\"pt\")[\"input_ids\"].squeeze().to(\"cuda:0\")\n","        for stop_word in stop_words\n","    ]\n","    stopping_criteria = StoppingCriteriaList(\n","        [StoppingCriteriaSub(stops=stop_words_ids)]\n","    )\n","    outputs = model.generate(\n","        **inputs,\n","        temperature=0.1,\n","        max_new_tokens=250,\n","        pad_token_id=tokenizer.eos_token_id,\n","        eos_token_id=tokenizer.eos_token_id,\n","        early_stopping=True,\n","        do_sample=True,\n","        no_repeat_ngram_size=4,\n","        stopping_criteria=stopping_criteria\n","    )\n","    display(Markdown((tokenizer.decode(outputs[0], skip_special_tokens=False))))\n","\n","def chat(context, question):\n","    prompt = make_prompt(context, question)\n","    make_inference(prompt)"],"metadata":{"id":"Lxkyuz2Gd-SW"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["### 기계독해\n","\n","- context에 네이버 뉴스 기사 같은것을 Drag&Drop\n","- question에 궁금한것을 물어봐요"],"metadata":{"id":"54ippvpUNs0K"}},{"cell_type":"code","source":["context = \"\"\"[딜사이트 범찬희 기자] 라이프자산운용이 서울대와 손을 맞잡고 빅데이터를 활용한 포트폴리오 최적화 모델 개발에 나선다.\n","라이프자산운용은 \"서울대와 함께 캡스톤 프로젝트(빅데이터 핀테크 과정)를 진행하고, 향후 국내외 금융과 경제 빅데이터를 활용한 포트폴리오 최적화 모델 개발에 나설 예정\"이라고 8일 밝혔다.\n","그간 산학협력 프로그램인 캡스톤 프로젝트에는 류근관 전 통계청장을 비롯해 경제학, 산업공학, 수리과학 등 다양한 분야의 서울대 교수진과 실무 전문가들이 참여해 왔다. 이들 전문가들과 함께 통계, 데이터사이언스, 기계학습 등 핀테크 전반을 망라하는 교육 프로그램을 진행해 빅데이터를 다룰 수 있는 전문가를 육성해왔다. 라이프자산운용은 빅데이트 핀테크 과정을 통해 캡스톤 프로젝트를 함께한다.\n","라이프자산운용은 빅데이터와 AI(인공지능)를 자산운용에 접목할 수 있는 방법을 고민한 끝에 캡스톤 프로그램에 참여키로 했다. 이에 강대권 라이프자산운용 대표가 직접 서울대를 찾아 프로젝트 계획을 발표해 연구원들의 호응을 이끌었다는 후문이다.\"\"\"\n","question =\"\"\"\n","캡스톤 프로젝트에 참여한 사람들을 알려줘\n","\"\"\""],"metadata":{"id":"LLbQN8JA-I9s"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["chat(context, question)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":443},"id":"Pie4baxG_G29","executionInfo":{"status":"ok","timestamp":1690507367287,"user_tz":-540,"elapsed":9204,"user":{"displayName":"전민규","userId":"17831368244275956825"}},"outputId":"9b2fbd16-3e42-4c98-d011-605a95f8a9d8"},"execution_count":null,"outputs":[{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.Markdown object>"],"text/markdown":"\n너는 지시사항을 매우 잘 따르는 AI 어시스턴트야.\n### 지시사항:\n - 주어진 문맥만을 사용하여 질문에 대한 답변을 자세하게 생성해줘.\n - 문맥에서 답할 수 없는 질문일 경우 \"해당 질문에 대한 답변을 문서에서 찾을 수 없습니다.\"라고 답변해.\n\n### 문맥:\n<문맥1>\n[딜사이트 범찬희 기자] 라이프자산운용이 서울대와 손을 맞잡고 빅데이터를 활용한 포트폴리오 최적화 모델 개발에 나선다.\n라이프자산운용은 \"서울대와 함께 캡스톤 프로젝트(빅데이터 핀테크 과정)를 진행하고, 향후 국내외 금융과 경제 빅데이터를 활용한 포트폴리오 최적화 모델 개발에 나설 예정\"이라고 8일 밝혔다.\n그간 산학협력 프로그램인 캡스톤 프로젝트에는 류근관 전 통계청장을 비롯해 경제학, 산업공학, 수리과학 등 다양한 분야의 서울대 교수진과 실무 전문가들이 참여해 왔다. 이들 전문가들과 함께 통계, 데이터사이언스, 기계학습 등 핀테크 전반을 망라하는 교육 프로그램을 진행해 빅데이터를 다룰 수 있는 전문가를 육성해왔다. 라이프자산운용은 빅데이트 핀테크 과정을 통해 캡스톤 프로젝트를 함께한다. \n라이프자산운용은 빅데이터와 AI(인공지능)를 자산운용에 접목할 수 있는 방법을 고민한 끝에 캡스톤 프로그램에 참여키로 했다. 이에 강대권 라이프자산운용 대표가 직접 서울대를 찾아 프로젝트 계획을 발표해 연구원들의 호응을 이끌었다는 후문이다.\n\n### 질문:\n\n캡스톤 프로젝트에 참여한 사람들을 알려줘\n\n### 답변:\n캡스톤 프로그램에는 류 근관 전 통계법원장을 비롯한 서울대 교수진과 전문가들이 참여했습니다. 이를 통해 통계, 데이터과학, 기계학습, 통계, 데이터, 머신러닝 등 다양한 영역에서 빅데이터를 분석하고 활용할 수 있도록 지원하고 있습니다. 이를 위해 캡스톤 프로젝트는 빅데이터와 인공지능을 활용한 포트폴리오를 최적화하는 것을 목표로 하고 있습니다.\n</끝>"},"metadata":{}}]}]}